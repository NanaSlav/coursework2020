<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
</head>
<body>
<div th:insert="common/navbar :: head"></div>
<div th:insert="common/delete-modal :: delete (path='/tasks/delete/' + ${task.getId()})"></div>

<div class="w3-container main-small">
    <div class="w3-display-container">
        <h1 class="w3-text-theme-dark" th:text="${task.getName()}"></h1>
        <a th:href="@{'/projects/' + ${task.getProject().getId()}}" th:text="${task.getProject().getName()}" class="w3-text-theme-dark w3-large" style="text-decoration: none"></a>
        <div class="w3-display-right">
            <div th:if="${!task.isDone()}" style="display: inline-block;">
                <form th:action="@{'/tasks/' + ${task.getId()} + '/done'}" method="post">
                    <button class="w3-btn w3-theme w3-xlarge w3-round-large w3-padding w3-margin" type="submit">Set done</button>
                    <a th:href="@{'/tasks/edit/' + ${task.getId()}}"  class="w3-btn w3-theme w3-large w3-round-large" style="display: inline-block">Edit</a>
                </form>
            </div>
            <div th:if="${task.isDone()}" style="display: inline-block">
                <button class="w3-btn w3-theme w3-xlarge w3-round-large w3-padding w3-margin" disabled>Done</button>
                <button class="w3-btn w3-theme w3-large w3-round-large" disabled style="display: inline-block">Edit</button>
            </div>
        </div>
    </div>
    <hr>
    <div class="w3-text-theme-dark w3-large" th:text="${task.getDescription()}"></div>
    <hr>
    <div th:if="${!task.getAttachments().isEmpty()}">
        <h2 class="w3-text-theme-dark">Attachments:</h2>
        <div th:each="file : ${task.getAttachments()}">
            <a th:href="@{'/avatar/files/' + ${file.getName()}}" download th:text="${file.getName()}" class="w3-text-theme" style="text-decoration: none"></a>
        </div>
        <hr>
    </div>
    <button  onclick="document.getElementById('delete-modal').style.display='block'"
             class="w3-btn w3-theme w3-xlarge w3-round-large w3-padding w3-margin">Delete task</button>

    <h2 class="w3-text-theme-dark">Comments:</h2>
    <div th:if="${task.getComments().isEmpty()}">
        <p class="w3-text-theme w3-large">There is no comments yet</p>
    </div>
    <div th:if="${!task.getComments().isEmpty()}">
        <div th:each="comment : ${task.getComments()}">
            <h3 class="w3-text-theme-dark" th:text="${comment.getAuthor().getUsername()}"></h3>
            <p th:text="${comment.getText()}" class="w3-text-theme"></p>
        </div>
    </div>
    <form th:action="@{'/tasks/' + ${task.getId() + '/comment/'}}" method="post" class="w3-container">
        <textarea class="w3-input w3-text-theme w3-large w3-border w3-round w3-hover-border-theme" rows="10" name="text"></textarea>
        <button class="w3-btn w3-theme w3-xlarge w3-round-large w3-padding w3-margin" type="submit">Comment</button>
    </form>

</div>
</body>
</html>